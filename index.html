<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汴梁奇案录 - 沉浸式宋代主题游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "SimHei", sans-serif;
        }

        body {
            background-color: #000;
            color: #fff;
            min-height: 100vh;
            overflow: hidden;
        }

        /* 全屏背景 */
        .fullscreen-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: -1;
        }

        /* 任务选择界面 */
        .task-selection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .task-circles {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 80px;
            margin-top: 50px;
        }

        .task-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
            text-align: center;
            padding: 10px;
        }

        .task-circle:hover {
            transform: scale(1.1);
            background-color: rgba(255, 255, 255, 0.6);
        }

        .task-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .task-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #fff;
        }

        /* 任务介绍页面 */
        .task-intro {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .intro-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: -1;
        }

        .intro-content {
            width: 60%;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.6);
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
        }

        .intro-title {
            font-size: 2.5rem;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .intro-text {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #fff;
            margin-bottom: 30px;
            text-align: justify;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .intro-btn {
            padding: 12px 30px;
            background-color: rgba(139, 69, 19, 0.8);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .intro-btn:hover {
            background-color: rgba(160, 82, 45, 0.9);
        }

        /* 任务场景 - 修改后的样式 */
        .task-scene {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1001;
        }

        .scene-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: -1;
        }

        /* 修改后的场景内容框 */
        .scene-content {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 23%;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px 15px 0 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .scene-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .scene-title {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .scene-text {
            font-size: 1rem;
            line-height: 1.4;
            color: #fff;
            margin-bottom: 15px;
            text-align: justify;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            max-height: 60px;
            overflow-y: auto;
        }

        .scene-choices {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 0;
        }

        .choice-btn {
            flex: 1;
            padding: 10px;
            background-color: rgba(139, 69, 19, 0.8);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-align: center;
        }

        .choice-btn:hover {
            background-color: rgba(160, 82, 45, 0.9);
        }

        .scene-next-btn {
            display: block;
            width: 200px;
            margin: 10px auto 0;
            padding: 10px;
            background-color: rgba(92, 61, 46, 0.8);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .scene-next-btn:hover {
            background-color: rgba(122, 92, 60, 0.9);
        }

        .result-content {
            text-align: center;
        }

        .result-title {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .result-text {
            font-size: 1rem;
            line-height: 1.4;
            color: #fff;
            margin-bottom: 15px;
            text-align: justify;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .achievement {
            font-size: 1.1rem;
            color: #fff;
            font-weight: bold;
            margin-top: 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #fff;
            cursor: pointer;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* 封面样式 */
        #cover {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9998;
            background: #000;
        }

        #coverSlider {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 1;
        }

        .top-center {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #fff;
            pointer-events: none;
        }

        .top-center h1 {
            font-size: 48px;
            margin-bottom: 20px;
            letter-spacing: 6px;
            text-shadow: 0 0 10px #d4af37;
            color: #fff;
        }

        .top-center p {
            font-size: 20px;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .top-center button {
            pointer-events: auto;
            padding: 12px 30px;
            border: 2px solid #d4af37;
            background: rgba(139, 69, 19, 0.9);
            color: #fff;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            transition: .3s;
        }

        .top-center button:hover {
            background: #d4af37;
            color: #000;
        }

        #backToStart {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 8px 16px;
            background: rgba(139, 69, 19, 0.85);
            color: #fff;
            border: 2px solid #d4af37;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            z-index: 10001;
        }

        /* 标题样式 */
        .page-title {
            font-size: 3rem;
            color: #fff;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            letter-spacing: 3px;
        }

        .page-subtitle {
            font-size: 1.5rem;
            color: #fff;
            text-align: center;
            margin-bottom: 50px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- 封面：背景 + 最顶层居中 -->
    <div id="cover">
        <div id="coverSlider"></div>
        <div class="top-center">
            <h1>清明上河图</h1>
            <p>走进北宋开封的十二时辰</p>
            <button onclick="enterScroll()">进入长卷</button>
        </div>
    </div>

    <!-- 任务选择界面 -->
    <div class="task-selection" id="task-selection" style="display: none;">
        <div class="fullscreen-bg" id="selection-bg"></div>
        <h1 class="page-title">汴梁奇案录</h1>
        <p class="page-subtitle">沉浸式宋代主题游戏</p>
        <div class="task-circles">
            <!-- 茶商主线 -->
            <div class="task-circle" data-task="tea">
                <div class="task-icon">🍵</div>
                <div class="task-title">汴河茶引谜案</div>
            </div>
            <!-- 酒肆学徒主线 -->
            <div class="task-circle" data-task="apprentice">
                <div class="task-icon">🍶</div>
                <div class="task-title">酒肆学徒试炼</div>
            </div>
            <!-- 桥工主线 -->
            <div class="task-circle" data-task="bridge">
                <div class="task-icon">🌉</div>
                <div class="task-title">虹桥修缮史志</div>
            </div>
            <!-- 风物捕快主线 -->
            <div class="task-circle" data-task="inspector">
                <div class="task-icon">🔍</div>
                <div class="task-title">汴河风物捕案</div>
            </div>
        </div>
    </div>

    <!-- 任务介绍页面 -->
    <div class="task-intro" id="tea-intro">
        <div class="intro-bg"></div>
        <div class="intro-content">
            <h2 class="intro-title">汴河茶引谜案</h2>
            <div class="intro-text">
                <p>政和七年，汴河春晨，薄雾如纱。你作为一名从江南来的茶商，怀揣着至关重要的"茶引"来到码头，准备与接头人老郑交接。然而老郑踪影全无，只留下一张意味不明的纸条。</p>
                <p>从码头的牌坊浮雕，到茶肆的暗语木牌，再到税署的复杂账簿......线索环环相扣。一个神秘的蓝布衫人，以及声名在外的孙羊正店，似乎都与你丢失的茶引息息相关。</p>
            </div>
            <button class="intro-btn" data-task="tea">开始挑战</button>
        </div>
    </div>

    <div class="task-intro" id="apprentice-intro">
        <div class="intro-bg"></div>
        <div class="intro-content">
            <h2 class="intro-title">酒肆学徒试炼</h2>
            <div class="intro-text">
                <p>政和年间，汴河边的春天来得特别早。你背着行囊，站在孙羊正店那扇气派的朱红大门前，欢门上挂的璎珞被风吹得轻轻晃动，门边的红栀子灯照亮了"皇家特许正店"的招牌。</p>
                <p>你是一名来投奔的"酒肆学徒"，要知道，在汴京，只有这种"正店"才有资格自己酿酒，街边那些小"脚店"都得到我们这儿来进货。接下来的十天，你要帮街坊解决各种小麻烦，攒够"酒德印记"，才能正式留下。</p>
            </div>
            <button class="intro-btn" data-task="apprentice">开始挑战</button>
        </div>
    </div>

    <div class="task-intro" id="bridge-intro">
        <div class="intro-bg"></div>
        <div class="intro-content">
            <h2 class="intro-title">汴河桥工·虹桥修缮志</h2>
            <div class="intro-text">
                <p>你是苏墨，汴京工部桥工司的年轻匠人，师从负责虹桥修缮的老工匠。近日汴河水位上涨，虹桥多处木构松动，且商贩占道、器械老化等问题加剧桥面损耗，工部限你七日之内完成虹桥"隐患排查+局部修缮"，并制定《虹桥养护细则》。</p>
                <p>你的任务不仅是修复桥梁，还要协调各方、记录工艺，最终需通过老工匠与工部主事的双重考核。</p>
            </div>
            <button class="intro-btn" data-task="bridge">开始挑战</button>
        </div>
    </div>

    <div class="task-intro" id="inspector-intro">
        <div class="intro-bg"></div>
        <div class="intro-content">
            <h2 class="intro-title">汴河风物捕案</h2>
            <div class="intro-text">
                <p>你是汴河旁新上任的"风物捕快"，职责是记录市井百态、核查业态合规。清明时节，汴河两岸烟火鼎盛，知府大人交给你一本《汴河风物册》，需走访十处特色店铺，既要记录真实情况，又要解决突发疑问。</p>
                <p>最终根据你的选择，解锁专属"汴河博古郎"或"市井知情人"名号。</p>
            </div>
            <button class="intro-btn" data-task="inspector">开始挑战</button>
        </div>
    </div>

    <!-- 任务场景页面 -->
    <div class="task-scene" id="task-scene">
        <div class="scene-bg" id="scene-bg"></div>
        <div class="scene-content">
            <button class="close-btn">×</button>
            <div class="scene-header">
                <h2 class="scene-title" id="scene-title">关卡标题</h2>
            </div>
            <div class="scene-text" id="scene-text">
                场景描述内容
            </div>
            <div class="scene-choices" id="scene-choices">
                <!-- 选项按钮将在这里动态生成 -->
            </div>
            <button class="scene-next-btn" id="scene-next-btn" style="display: none;">进入下一关</button>
        </div>
    </div>

    <button id="backToStart" style="display: none;">返回卷首</button>

    <script>
        // 路径配置
        const root = 'https://anan1133.github.io/qingming';

const coverImgs = [
    `${root}/清明上河园游戏/01虹桥晨雾.png`,
    `${root}/清明上河园游戏/04书院午后.png`,
    `${root}/清明上河园游戏/09御街花市.png`
];

const picList = [
    `${root}/清明上河园游戏/01虹桥晨雾.png`,
    `${root}/清明上河园游戏/02码头正午.png`,
    `${root}/清明上河园游戏/03鼓楼夜市.png`,
    `${root}/清明上河园游戏/04书院午后.png`,
    `${root}/清明上河园游戏/05贡院黄昏.png`,
    `${root}/清明上河园游戏/06相国寺夜雪.png`,
    `${root}/清明上河园游戏/07瓷巷春烧.png`,
    `${root}/清明上河园游戏/08官窑秋点.png`,
    `${root}/清明上河园游戏/09御街花市.png`,
    `${root}/清明上河园游戏/10洛阳春闱.png`,
    `${root}/清明上河园游戏/11归乡长卷.png`
];

// 添加关卡背景图映射
const sceneBackgrounds = {
    tea: [ // 茶商主线
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡1.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡2.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡3.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡4.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡5.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡6.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡7.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡8.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡9.jpg`,
        `${root}/清明上河园游戏/背景/1汴河茶引谜案/关卡10.jpg`
    ],
    apprentice: [ // 酒肆学徒主线
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡1.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡2.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡3.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡4.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡5.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡6.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡7.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡8.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡9.jpg`,
        `${root}/清明上河园游戏/背景/2酒肆学徒试炼/关卡10.jpg`
    ],
    bridge: [ // 桥工主线
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡1.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡2.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡3.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡4.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡5.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡6.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡7.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡8.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡9.jpg`,
        `${root}/清明上河园游戏/背景/3虹桥修缮史志/关卡10.jpg`
    ],
    inspector: [ // 风物捕快主线
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡1.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡2.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡3.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡4.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡5.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡6.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡7.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡8.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡9.jpg`,
        `${root}/清明上河园游戏/背景/4十铺捕快寻踪/关卡10.jpg`
    ]
};


        // 封面轮播
        let coverIdx = 0;
        const coverSlider = document.getElementById('coverSlider');
        function changeCover() {
            coverSlider.style.backgroundImage = `url(${coverImgs[coverIdx]})`;
            coverIdx = (coverIdx + 1) % coverImgs.length;
        }
        changeCover();
        setInterval(changeCover, 4000);

        // 进入长卷
        function enterScroll() {
            document.getElementById('cover').style.display = 'none';
            document.getElementById('task-selection').style.display = 'flex';
            document.getElementById('backToStart').style.display = 'block';
            // 设置任务选择界面的背景图片
            document.getElementById('selection-bg').style.backgroundImage = `url(${picList[0]})`;
            initGame();
        }

        // 场景切换
        function setScene(n) {
            const taskBgList = sceneBackgrounds[currentTask];
            if (taskBgList && taskBgList[n]) {
                document.getElementById('scene-bg').style.backgroundImage = `url(${taskBgList[n]})`;
            } else {
                // 备用方案：使用原来的逻辑
                document.getElementById('scene-bg').style.backgroundImage = `url(${picList[n]})`;
            }
        }

        // 任务数据
        const taskData = {
            tea: {
                title: "汴河茶引谜案",
                scenes: [
                    {
                        title: "关卡1：码头惊变",
                        text: "晨雾弥漫的汴河码头，约定的接头人老郑不见踪影，只在他站过的位置留下一张画着\"艹\"符的纸条。一个船夫倚着缆绳，指着码头牌坊上的四块浮雕（茶篓叠船锚、船锚勾粮食），叉着腰问你：\"想知老郑去向？先说说，哪块浮雕和你手里这线索对得上？\"",
                        choices: [
                            { 
                                text: "茶篓叠船锚", 
                                result: "船夫眼睛一亮，从怀里摸出块刻着\"漕\"字的木牌塞给你：\"老郑被个穿蓝布衫的人叫去临河茶肆了。拿这漕帮牌子给王二掌柜看，运河上的事，他们都得给几分面子。\"" 
                            },
                            { 
                                text: "船锚勾粮食", 
                                result: "船夫脸色一沉，后退半步：\"看你不像正经茶商，倒像码头的水贼！\"他转身要走，你急忙拉住他，好说歹说，他才扔给你一张皱巴巴的船票：\"'茶'字草字头3画，下面'余'6画，共9画，这票上的编号对上了，我再指路。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡2：茶肆试探",
                        text: "临河茶肆里，王二掌柜捏着块被茶渍浸得发暗的木牌，正面刻着\"人在草木间\"，背面写着\"酉时\"。他晃着木牌问：\"那蓝布衫的汉子留了这牌子，说'懂行的才看得懂'。你说说，这'人在草木间'是个啥字？'酉时'又对应啥时辰？\"",
                        choices: [
                            { 
                                text: "\"草\"字，中午11点-1点", 
                                result: "掌柜摇头：\"这解得不对，'人在草木间'怎能是'草'？\"他倒出一杯金黄透亮的茶汤：\"先辨出这是什么茶\"------看其形\"色翠、形美\"，闻其香\"气清、味醇\"。辨出是龙井，才能获得税署地址。\"" 
                            },
                            { 
                                text: "\"茶\"字，傍晚5点-7点", 
                                result: "掌柜咧嘴一笑，从柜台下抽出张纸条：\"早说你是漕帮介绍来的！'茶'字拆开，正是'人在草木中'，暗合茶之本性。税署在东行三里。税署的李吏是我远房表亲，提我'王二'的名字，他能给你行方便。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡3：税署受阻",
                        text: "税署里，李吏翻着本厚厚的账簿，头也不抬：\"想查蓝布衫人的备案？咱大宋的商税，过税值百抽二，住税值百抽三。先算道题------茶商甲缴了32贯，乙比甲少8贯，你说乙缴了多少贯？\"",
                        choices: [
                            { 
                                text: "24贯", 
                                result: "李吏点点头，直接翻查记录：\"蓝布衫人叫李二，是江南茶商，常去虹桥茶摊，你去那找找。\"" 
                            },
                            { 
                                text: "28贯", 
                                result: "小吏把账簿一合：\"算错了！这茶税都算不明白，官府怎知你是否偷漏税款？\"你需重新计算，耽误了些时间。" 
                            }
                        ]
                    },
                    {
                        title: "关卡4：虹桥茶摊",
                        text: "虹桥茶摊前，邻摊的漕夫踢了踢地上的一张纸条，上面写着\"3饼龙团 + 2两雨前茶 = 110文\"，而价目牌上\"龙团茶\"的单价处是空的。他朝你扬扬下巴：\"李二说了，算不出龙团茶每饼多少文，就别想碰他的抽屉。你算算？\"（已知雨前茶25文/两）",
                        choices: [
                            { 
                                text: "20文", 
                                result: "漕夫一指茶摊抽屉：\"李二的规矩，密码就是茶价。\"打开抽屉，发现完整的\"孙羊正店进货单\"，上面批注着\"以次充好，低价抢客，断我生路\"。" 
                            },
                            { 
                                text: "25文", 
                                result: "漕夫刚要说话，茶摊铜铃突响------李二回来了。他见你算错账，疑心你是孙羊正店的探子：\"想证明清白？那就按汴京规矩，用你随身带的江南新茶与我'斗茶'，比试汤色、水痕！赢了，抽屉里的东西你再看。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡5：正店对质",
                        text: "孙羊正店的掌柜把三块茶饼往柜台上一放，一块有龙纹印记、质地紧实如铁，两块无印记、质地松散。他抱臂质问：\"你说我店以次充好？行，那你先说说，哪块是建州北苑官焙、印有龙凤纹饰的'龙团贡茶'？认对了，我再跟你掰扯。\"",
                        choices: [
                            { 
                                text: "无印记、质地松散的茶饼", 
                                result: "掌柜哈哈大笑：\"你连上品龙团，纹路清晰，坚如金石都认不出，还敢来闹事？\"伙计将你赶出时，你撞翻柜台后酒坛，发现坛底压着的\"李二的借条\"，上写\"借孙羊正店银50两，以茶引抵押\"。你才知二人早有债务纠葛。" 
                            },
                            { 
                                text: "有龙纹印记、质地紧实的茶饼", 
                                result: "掌柜脸色骤变，凑近低声道：\"算你懂行！这龙团贡茶，千金易得，一饼难求。是李二偷了你的茶引，他怕你顺利交引抢他生意，今晚在汴河渡口交易，快去！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡6：渡口寻引",
                        text: "汴河渡口，李二指着岸边5个盖着帆布的木箱笑道：\"茶引就藏在其中一个箱子里，密码是这渡口的汴河船数。你数数，这儿一共停了几艘船？我们跑船的有规矩，首尾相连的算一艘，单独停泊的也算一艘。\"",
                        choices: [
                            { 
                                text: "5艘", 
                                result: "你输入\"5\"，5号木箱应声而开，里面正是你的茶引。李二慌了神：\"别拿！我给你孙羊正店偷税的账簿！\"他掏出一本泛黄账簿，上面是详细的偷税记录。" 
                            },
                            { 
                                text: "6艘", 
                                result: "你输入\"6\"，箱子毫无反应。李二嘲笑：\"漕船计数都数不清！\"说着就要毁掉茶引。你急忙纠正，虽最终拿回茶引，但已被水泼湿，字迹模糊需烘干，而账簿也被撕去了关键页。" 
                            }
                        ]
                    },
                    {
                        title: "关卡7：官府举报",
                        text: "开封府衙，府尹指着那本残缺的账簿问你：\"孙羊正店的偷税记录，一月12贯，二月18贯，四月30贯。看这每月递增的规律，三月该是多少贯？补对了，我才信这账簿为真，派人查他。\"",
                        choices: [
                            { 
                                text: "24贯", 
                                result: "府尹点头：\"数列规律无误，账簿可信！\"当即派差役随你前往孙羊正店仓库查货。" 
                            },
                            { 
                                text: "20贯", 
                                result: "府尹皱眉：\"这增幅不对，你再细算。\"你重新算出24贯后，府尹虽下令，但言差役人手不足，让你先去仓库盯着，支援稍后便到。" 
                            }
                        ]
                    },
                    {
                        title: "关卡8：仓库查货",
                        text: "孙羊正店的仓库门上挂着密码锁，旁贴纸条：\"密码是'孙羊'的声母加上门外摊子上的竹篓数。\"你探头望去，见摊上竹篓分明。",
                        choices: [
                            { 
                                text: "SY3", 
                                result: "密码错误，锁亮红灯。正着急，赶来的差役道：\"密码改了！刚问过伙计，按'孙'字拼音SUN来算。\"输入SUN2后门开，虽查获劣茶，但凭证需回府衙补办，只得到一张查货记录。" 
                            },
                            { 
                                text: "SY2", 
                                result: "差役上前，依据《宋刑统》中关于商户违禁的条款，一脚踹开仓库门。里面堆满印着\"江南新茶\"假标签的劣质茶。差役出示封条：\"奉府尹令，查封！这是凭证，你拿去补办茶引。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡9：补办茶引",
                        text: "税署吏员推过一张空白茶引文书，指着\"茶叶产地\"栏问：\"你这江南新茶，出自何处？宋代江南名茶辈出，但首推'顾渚紫笋'与'西湖龙井'的故乡，总该知道吧？填对，茶引方能生效。\"",
                        choices: [
                            { 
                                text: "杭州", 
                                result: "吏员摇头：\"杭州虽好，然论及贡茶渊源，湖州更负盛名。产地填错，需湖州茶商的担保信。\"你只得托人办理，耽误了交易时机。" 
                            },
                            { 
                                text: "湖州", 
                                result: "吏员验过凭证，盖章道：\"湖州顾渚紫笋，唐代即为贡品。有府尹凭证，免手续费。另，下月汴梁茶市品鉴会，给你张VIP帖，去结识些大客商。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡10：茶市成交",
                        text: "汴梁茶市内，老练的买家捻须问道：\"你既历经磨难，当知宋代茶政实行'引法'，税率究竟几何？说对了，这生意好谈；说不对，我可要压价了。\"",
                        choices: [
                            { 
                                text: "20%", 
                                result: "买家一笑：\"果然是懂行的VIP！宋代茶税时而十取其二，时而十取其三，你说得不错。\"他欣然加价10%，全数收购你的茶叶。" 
                            },
                            { 
                                text: "10%", 
                                result: "买家皱眉：\"这税率说低了。太平兴国年间，官售茶斤就曾课税十之三。\"他坚持压价至九成。虽然后来你凭\"举报凭证\"赢得信任，补回部分差价，赚得不多，但赢得了口碑。" 
                            }
                        ]
                    }
                ]
            },
            apprentice: {
                title: "酒肆学徒试炼",
                scenes: [
                    {
                        title: "关卡1：麻杆择取",
                        text: "你刚走到正店右边，一个禁军壮汉就举着两根麻杆朝你招手：\"小兄弟，来来来，帮哥选根舀酒的麻杆！这根直溜，顶端没裂，看着结实，就怕装酒不多；那根粗壮，底部带凹槽，能多装点儿，就怕漏。你天天跟酒打交道，说哪根靠谱？\"",
                        choices: [
                            { 
                                text: "杆身粗、底部有凹槽", 
                                result: "壮汉哈哈大笑：\"跟哥年轻时一样实在！能多装点是点！不过可得小心，这凹槽要是没处理好，酒可容易顺着缝儿漏光。来，这块禁军腰牌送你，凭这个去羊肉铺买肉省5文！前面香铺的老板我也熟，买块香配酒，那才叫舒坦！\"" 
                            },
                            { 
                                text: "杆身直、顶端无裂痕", 
                                result: "壮汉一拍你肩膀：\"懂行！这杆舀酒不洒，稳当！哥再教你认认酒桶上'禁军专用'的刻痕，咱们禁军喝酒都有定例，酒桶都是特制的！喏，这张酒窖通行条给你，去后院找老掌柜，他能带你进酒窖开开眼！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡2：酒缸寻律",
                        text: "你顺着禁军指的路绕到后院，老掌柜正对着四层大酒缸发愁：\"这酒缸的摆放藏着酿酒的门道，我琢磨半天也没看明白。咱们酿酒，讲究'一选二曲三蒸'，步骤环环相扣。你看这缸，要么是每层比上一层少3个，对应'选材、发酵、蒸馏'三步；要么是四层对应四季，每层数量都是3的倍数，应和天地人'三才'之理。你觉得是哪一种？\"",
                        choices: [
                            { 
                                text: "每层比上一层少3个", 
                                result: "老掌柜眼睛一亮：\"对喽！就是这样，步步递减，暗合酿酒收束精华之道！来，用你这通行条开酒窖看看，满窖都是羊羔酒！这羊羔酒是用肥嫩羊肉配上黍米酿的，富贵人家才喝得起！香铺刘老板那儿的沉香熏酒更是一绝，你去问问？再送你张酒缸年份卡！\"" 
                            },
                            { 
                                text: "4层对应四季，每层是3的倍数", 
                                result: "老掌柜指着缸底刻字说：\"你这想法妙啊，合乎古礼！你看这缸底，'政和二年造'，这可是三年陈缸！咱们这的酒缸都是越陈越好，能让酒体更醇厚。送你一片陈酒渍纸，去香铺能换半块乳香。对了，正店门口的花摊新到了牡丹，配酒好看得很！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡3：香客取舍",
                        text: "你走进刘家香铺，刘老板搓着手叹气：\"这边是要沉香的士人，说要佩着去正店赴宴，现在文人雅集都兴'佩香'，以示风雅；那边是要乳香的妇人，买回去熏衣裳，这乳香熏衣，不仅能留香，还能防虫防蛀。货就剩这么点儿，先给谁好？你帮我拿个主意，事后送你试香礼！\"",
                        choices: [
                            { 
                                text: "先给妇人乳香", 
                                result: "妇人高兴地帮老板吆喝起来：\"这小哥真明事理！我们熏衣的香，多是乳香、龙脑这类，用炭火慢熏，香味能持续整日。\"刘老板塞给你一个乳香香包：\"带这个去正店，酒保会多给你一碟蜜饯！记得用禁军腰牌去羊肉铺买羊杂，配乳香酒最香！\"" 
                            },
                            { 
                                text: "先给士人沉香", 
                                result: "士人佩上香后邀你：\"小兄弟有眼光！这沉香并非中原所产，是从南洋诸国经海上运来的，气息清远，正合宴饮之趣。走，去正店喝羊羔酒，我教你'佩香赴宴'的规矩！\"刘老板也塞给你一把沉香碎：\"带这个去花摊，花农准送你枝牡丹配香！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡4：花酒相配",
                        text: "回到正店门口，花农把牡丹和芍药摆在你面前：\"小哥你看，这牡丹是花王，象征富贵，咱们汴京人最爱，配80文的羊羔酒显雅致；芍药是'花中宰相'，花期长，更亲民些，配72文的银瓶酒正好。你觉得哪种花配店里的酒更合适？选对了送你枝鲜的！\"",
                        choices: [
                            { 
                                text: "牡丹配羊羔酒", 
                                result: "花农送你一枝牡丹，又递来一张羊肉铺折扣券：\"会享受！这牡丹就得配羊羔酒，才显出'锦绣富贵'的意境。凭这个买羊杂再省3文，配牡丹酒绝了！\"你持花进店，掌柜赞道：\"懂搭配，稍后雅间有客人邀你共饮！\"" 
                            },
                            { 
                                text: "芍药配银瓶酒", 
                                result: "花农送你芍药：\"这花是'酒曲暗号'，以前酿酒师傅会看芍药花开来判断气温，决定下曲的时机，带去跟说书人换段故事！\"路过酒保见你带着乳香香包，额外塞你一碟蜜饯：\"蜜饯解酒，是咱们这的规矩，配芍药酒解腻！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡5：斤两细算",
                        text: "羊肉铺前，客人对着\"斤六十足\"的价牌皱眉，屠夫喊你帮忙：\"客官问整羊多少斤，我忙着切肉算不过来。按市价3.75文一斤，整羊600文，咱大宋一斤是十六两，所以'斤六十足'是老说法，意思是一斤肉按六十文算，可不是一共六十斤！你说这整羊是160斤还是60斤？\"",
                        choices: [
                            { 
                                text: "160斤", 
                                result: "客人笑说：\"算得对！走，用羊杂下酒去！\"屠夫送你羊杂和磨刀石碎片：\"带这个去说书人那儿，他最爱听磨刀故事！对了，旅店掌柜收羊油，羊油不光能吃，还能做蜡烛、润车轴，能换住宿优惠券！\"" 
                            },
                            { 
                                text: "60斤", 
                                result: "屠夫赠你羊油，教你：\"小兄弟，咱们这行磨刀讲究'斜磨出锋，平磨出刃'，去跟说书人说这技巧，他送你《东京梦华录》残页！说书人就在前面，听完去旅店歇脚正好！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡6：特权揭秘",
                        text: "羊肉铺旁的茶棚里，说书人\"啪\"地一拍醒木：\"话说这孙羊正店，为何独他能酿羊羔、银瓶这等贵酒？这可是有来头的！依你看，这特权是啥？是官府特批了'酿酒牌照'，许他酿还能批发给脚店，私下酿酒那可是要吃板子的！还是说他家老板朝中有人，认识哪位官老爷，才能开这绿灯？\"",
                        choices: [
                            { 
                                text: "官府给酿酒牌照", 
                                result: "说书人竖起大拇指：\"门儿清！咱们汴京实行'扑买'制度，正店需向官府买'曲引'，有了这酿酒配额才算合法。\"说着送你一张《东京梦华录》残页：\"带这个去'久住王员外家'旅店，掌柜给你8折！那儿常有学子备考，你还能借科举范文看！\"" 
                            },
                            { 
                                text: "老板认识官老爷", 
                                result: "说书人嘿嘿一笑：\"这么想也寻常，不过啊，咱们官家（皇帝）重视酒税，酿酒权管得严，光靠人情可不行。\"他还是送了你一张说书入场券：\"下次来听'皇帝临幸正店'的故事！\"又提醒你：\"那旅店有商人存了南方来的酒，你去能打听些外地酒价！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡7：包房分配",
                        text: "走到'久住王员外家'旅店，掌柜拽着你发愁：\"只剩一间上等包房了！这位学子要备考，打算参加今年的'锁厅试'，需清净温书，得住上个把月；那位商人要存酒，只住三五天，但货急着出手。俩人都等着，你说该分给谁？分对了给你诚信价！\"",
                        choices: [
                            { 
                                text: "分给学子", 
                                result: "学子感激地赠你一枚墨锭：\"多谢小哥！此乃徽州松烟墨，写字墨香清远，带这个去正店雅间，里头的文人见了会邀你共写酒评！\"掌柜也送你一张8折券：\"离店前买些笔墨纪念物能用！对了，雅间里摆着官窑瓷器，你去开开眼？\"" 
                            },
                            { 
                                text: "分给商人", 
                                result: "商人塞给你一张外地酒价单：\"小哥够意思！这上面记着江南'黄酒'的价，和咱们汴京的'白酒'大不同。带这个去正店，酒保准给你尝新！\"掌柜送你一本《老字号名录》：\"正店门口那'拒马杈子'的来历，名录里可有记载！雅间温着酒呢，快去！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡8：温酒之法",
                        text: "进了雅间，客人指着桌上的\"注子\"（执壶）和\"注碗\"问你：\"这新开的银瓶酒，该怎么温才好？这注碗里若只放半碗热水，让酒壶斜靠着，酒气不易散，能保留清冽；要是灌满热水把壶整个温透，喝着就更暖身子。你懂行，说该放多少？\"",
                        choices: [
                            { 
                                text: "半碗热水", 
                                result: "客人欣然点头：\"是知味的人！温酒不沸，方得其真味。\"随即邀你一同品评，还赠你一片官窑瓷片：\"这瓷片胎薄釉润，是官窑上品，带它去擦拒马杈子，能看清刻字！那杈子上据说有官家临幸的痕迹，你去瞧瞧！\"" 
                            },
                            { 
                                text: "满碗热水", 
                                result: "客人笑道：\"爽快！羊羔酒性温，倒是适合这般热热地喝。\"让你尝了新酒，酒保在一旁补充：\"银瓶酒其实半温就好。不过您既选了，记得去拒马杈子旁找老掌柜验证这温酒法！\"又递你块细布：\"巧了，老掌柜正愁没人帮忙擦刻字呢！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡9：杈子擦拭",
                        text: "回到正店门前，老掌柜举着布喊你：\"快来！这'拒马杈子'可是皇家特许的象征，寻常店铺只能用栅栏，唯有正店可用此物。上面刻了字，年深日久看不清了。依你看，是该重点擦交叉处，皇家标志多刻于醒目之位；还是擦底部，有些铭文就爱藏在这种不显眼的地方？\"",
                        choices: [
                            { 
                                text: "擦交叉处", 
                                result: "你用官窑瓷片一擦，果然显出\"政和年间御临\"六个字！老掌柜大喜，赠你御临纪念牌：\"好眼力！有此牌在，守城士兵见之便知是宫里常客，行李畅通无阻！转运站正在清点酒桶，你去帮忙能得张尝鲜券！\"" 
                            },
                            { 
                                text: "擦底部", 
                                result: "你仔细擦拭底部，露出了\"正店七十二家之首\"的刻字。老掌柜连连称奇，教你识别杈子的规制，赠你正店徽章：\"咱们汴京正店有七十二家，咱们店可是头一份！凭这徽章去转运站，禁军兄弟会多给你张通行卡！快去，酒桶快装完了！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡10：酒桶清点",
                        text: "到了转运站，禁军壮汉指着酒桶喊你：\"小兄弟来得正好！屋前堆着8只空桶，刚又运过来3只。不过这木桶运输，最怕有暗漏，你说咱们是直接算11只装车，还是得仔细瞧瞧，万一有1只漏了，就算10只？你帮我拿个主意，总共该报多少只？\"",
                        choices: [
                            { 
                                text: "11只", 
                                result: "壮汉清点无误，送你一张军酒尝鲜券：\"痛快！这军酒劲儿大，是用双倍酒曲酿的。\"守城士兵见你的御临纪念牌，直接放行。离店时，卖花女送你包干花：\"配您的军酒正合适，记得下次再来！\"你用旅店的8折券买了只迷你酒壶，圆满收尾。" 
                            },
                            { 
                                text: "10只", 
                                result: "壮汉仔细一查，果然有一只桶沿有湿痕，他赞你心细，赠你转运站通行卡：\"漕运繁忙，下次你来优先派活！\"离店时，羊肉铺屠夫老远就喊你：\"记得用腰牌来买肉啊！\"你用通行卡换了张印着正店欢门的明信片，留作纪念。" 
                            }
                        ]
                    }
                ]
            },
            bridge: {
                title: "虹桥修缮史志",
                scenes: [
                    {
                        title: "关卡1：木构探查",
                        text: "你扛着木工尺刚到虹桥，老工匠就从桥底探出头喊你：\"墨小子，先把桥底变形的榫卯摸清楚！这虹桥是'叠梁拱'，全靠榫卯咬合，不用一钉一铆！你是爬上去看木材纹理，辨是不是耐造的楠木？还是回工房翻《桥工档案》，查当初建桥用的啥料？\"",
                        choices: [
                            { 
                                text: "攀爬取样", 
                                result: "你系上安全绳爬上去，刮下木屑一看，纹理紧实，果然是楠木。老工匠一边教你榫卯矫正的窍门，一边说：\"楠木耐水防蛀，是修桥的上选，官家修宫殿也常用它。\"" 
                            },
                            { 
                                text: "查阅档案", 
                                result: "你跑回工房找到档案，虽查到\"皆以楠木为之\"的记录，却没写具体榫卯位置。等返回桥下，最佳观察光线已过，桥下昏暗，细节难辨。" 
                            }
                        ]
                    },
                    {
                        title: "关卡2：仪向校准",
                        text: "工部主事指着桥角鸟形测风仪皱眉：\"苏墨！这仪器的鸟首指向关乎漕船安危！《营造法式》里有载，'候风鸟'需首指风来之处。你赶紧弄------是看鸟羽朝向、比对河面波纹定风向，手动调正？还是去借麻绳，先把鸟羽绑住固定？\"",
                        choices: [
                            { 
                                text: "麻绳固定", 
                                result: "你借来麻绳绑住鸟羽，主事摇头：\"麻绳易朽，遇风雨则断，岂是长久之计？\"平白多了份复查的活儿。" 
                            },
                            { 
                                text: "观察校准", 
                                result: "你蹲在桥边看波纹、对鸟羽，三两下调准。主事颔首：\"《河防通议》说过，'辨风识水，乃桥工之要'。\"还提醒你：\"漕船午后过，这时候多盯桥况准没错。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡3：绳索甄选",
                        text: "绳索摊主递来麻、棕两种绳：\"桥工小哥，要便宜麻绳还是耐拉棕绳？麻绳取自麻茎，棕绳取自棕树皮，力道不同------你是问清承重再选？还是直接拽拽试试？\"",
                        choices: [
                            { 
                                text: "问承重", 
                                result: "你问：\"老板，这俩绳最多扛多少斤？我要绑木梁。\"摊主答：\"棕绳能受三百斤，麻绳二百斤。绑扎木梁，需用强韧之索。\"" 
                            },
                            { 
                                text: "拉扯测试", 
                                result: "你使劲一拽，麻绳\"啪\"地断了。摊主脸一黑：\"小哥，这麻绳本就不及棕绳坚韧，经不起你这般试法！\"你只好掏钱赔偿，耽误许久。" 
                            }
                        ]
                    },
                    {
                        title: "关卡4：借物互助",
                        text: "修缮需垫防滑木板，可备用料不够。鞋铺旁有块厚木板，你走过去：\"老板，能否借木板一用？修完即还------我是帮你修补破损鞋架抵数？还是加倍还你新木料？\"",
                        choices: [
                            { 
                                text: "等价交换", 
                                result: "老板一听\"帮修鞋架\"，立马点头：\"好！市井相助，便是这个理！\"木板合用，后来老板还真帮你留意到一处松动的栏杆。" 
                            },
                            { 
                                text: "诚信担保", 
                                result: "你说\"加倍还新木料\"，老板虽借了，却惦记着：\"新木料需是松木，不可用柳木充数。\"隔一会儿就来催问，搅得你难专心。" 
                            }
                        ]
                    },
                    {
                        title: "关卡5：工具择取",
                        text: "刀剪摊主摆开宽刃、窄刃两种凿子：\"小哥，凿分宽窄，各有所司。凿榫卯用窄刃，削木梁用宽刃------你是知道要啥，各拿5把？还是问我哪种更适合修虹桥木构？\"",
                        choices: [
                            { 
                                text: "听经验建议", 
                                result: "你问了摊主，虽选对凿子，却因听得入迷，少拿2把窄刃。凿榫卯时不够用，只得跑回补买，一来一回，耽误了大半个时辰。" 
                            },
                            { 
                                text: "按需购买", 
                                result: "你说：\"宽刃削面，窄刃凿眼，各来5把。\"摊主笑着打包：\"是行家！《梓人遗制》里图样也是这般分明。\"施工效率大增，老工匠夸你\"没白教\"。" 
                            }
                        ]
                    },
                    {
                        title: "关卡6：桥面调解",
                        text: "轿子与马卡在路中，轿夫喊\"文官优先\"，马夫嚷\"武官先行\"。运料工匠催你：\"苏小哥，快劝劝！这虹桥乃南北通衢，堵不得啊！------你是说修桥要紧，让双方各退半步从桥两侧过？还是指文官走桥下过道，武官牵马从桥面边过？\"",
                        choices: [
                            { 
                                text: "指引分流", 
                                result: "你让文官走桥下过道，文官沉脸：\"我乃朝廷命官，依礼应从正桥而行，岂可走下道？\"僵持许久才肯走，耽误了工程。" 
                            },
                            { 
                                text: "劝双方退让", 
                                result: "你说：\"各位，桥面在修，堵着谁都走不了！《仪制令》有云，'贱避贵，去避来'，但修桥事关公益，还请行个方便。\"两人退让，材料车顺利通过。" 
                            }
                        ]
                    },
                    {
                        title: "关卡7：船工示警",
                        text: "一艘漕船桅杆太高要蹭桥，船工没发觉。老工匠急喊：\"快！你是跑过去喊船工放下桅杆？还是找热心人借长杆，伸出去顶住桅杆别撞？\"",
                        choices: [
                            { 
                                text: "大喊示警", 
                                result: "你撒腿跑到桥头大喊：\"桅杆太高！快放下来！\"船工反应过来，熟练地放下活动桅杆，刚好穿桥洞。船长拎酒来谢：\"多亏小哥！这船货要是撞了，我可赔不起！\"" 
                            },
                            { 
                                text: "借杆顶住", 
                                result: "你借来长杆顶住桅杆，虽没撞上，但杆头铁钉还是在桥洞上方擦出了一道深痕。老工匠叹气：\"这划痕又得费工补，下次反应得快些！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡8：运钞应急",
                        text: "一辆运钞独轮车下桥失控，车夫拦不住，前方行人没察觉。老工匠大喊：\"墨小子！快！你是冲上去帮车夫稳住车把？还是喊行人赶紧躲开？\"",
                        choices: [
                            { 
                                text: "稳住车把", 
                                result: "你箭步冲上去，利用下坡惯性顺势控住车把，车夫趁机拽刹车，行人惊险躲开。车夫要给铜钱，你摆手：\"桥工本分，维护道途畅通而已。\"" 
                            },
                            { 
                                text: "提醒避让", 
                                result: "你大喊\"快躲开！\"，行人闻声躲开，可独轮车因无人控制，直直撞上桥头石墩，铜钱撒了一地。你只好帮车夫捡钱，修缮活儿全停了。" 
                            }
                        ]
                    },
                    {
                        title: "关卡9：饮子选购",
                        text: "三伏天修桥，渴得冒烟，老工匠让你买饮子。香饮子摊主招呼：\"小哥，要清热薄荷饮子，还是解暑甘草饮子？薄荷利头目，甘草和中气------你是问哪种更解渴，按人数多买几碗？还是先尝一碗，觉得好喝再买？\"",
                        choices: [
                            { 
                                text: "先尝后买", 
                                result: "你先尝薄荷饮子，确实解渴，可回头买时正赶上漕船靠岸，船工们也来买饮子，排起了长队，耽误半个时辰，工匠们渴得没力气。" 
                            },
                            { 
                                text: "问解渴功效", 
                                result: "你问：\"天热，哪种最解渴？我们有五人。\"摊主说：\"薄荷饮子，以井水湃过，最是生津止渴！\"你买五碗，工匠们喝了干劲十足。" 
                            }
                        ]
                    },
                    {
                        title: "关卡10：银锭加固",
                        text: "最后一步，需加固桥下石墩间的\"银锭\"铁细腰，防石墩移位。老工匠递你铁锤：\"墨小子，这'银锭榫'是石桥防移的关键！------你是用锤子敲，听声音辨松紧？还是拿直尺量铁细腰和石墩的缝，看合不合规？\"",
                        choices: [
                            { 
                                text: "精准测量", 
                                result: "你拿直尺细细测量，却发现多数缝隙是因石墩本身经年磨损所致，并非铁件松动，无法准确定位，事倍功半。" 
                            },
                            { 
                                text: "经验判断", 
                                result: "你挨个敲击，脆响为紧，闷响为松，很快找出2处松动加固好。老工匠笑：\"善！'百工理事，贵在熟尔'，有你师父当年的样儿！\"" 
                            }
                        ]
                    }
                ]
            },
            inspector: {
                title: "汴河风物捕案",
                scenes: [
                    {
                        title: "关卡1：酒肆疑云",
                        text: "码头酒肆里，粮商甲说：\"今儿总算能喝上新酿酒，可惜只能偷偷凑两三个人喝！\"店主冲你摆手：\"捕快小哥别误会，我们可没聚众饮酒！官家确曾下诏，禁止'夜聚晓散'，但白日小酌无妨。\"",
                        choices: [
                            { 
                                text: "\"大叔，我懂规矩，就是想问，这彩缎挂着是为了招船上客人吧？\"", 
                                result: "店主放下心：\"正是！这叫'彩楼欢门'，是酒楼幌子，专引四方客。\"主动带你看临水桌椅，说专为船夫设，依水营商。" 
                            },
                            { 
                                text: "\"粮商大哥，新酒是用今年的新粮酿的？难怪你们这么高兴！\"", 
                                result: "粮商们打开话匣：\"对啊！'新粮出好酒'，尤其是这糯米新收，酿出的酒格外香醇。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡2：纸马订单",
                        text: "王家纸马铺掌柜发愁：\"刚有人订纸扎楼阁，要跟《东京梦华录》里'纸衮叠'样式一样，可我忘了怎么叠！\"你瞥到铺外扫墓队，又见门上竖牌。",
                        choices: [
                            { 
                                text: "\"先问扫墓队吧，他们刚去上坟，肯定知道现在祭祀常用样式！\"", 
                                result: "扫墓队说：\"如今祭祖，纸马楼阁、金山银山都不可少，是'事死如事生'嘛。\"" 
                            },
                            { 
                                text: "\"《东京梦华录》里写得细，先查册子准没错，免得问错耽误事！\"", 
                                result: "你帮掌柜翻到记载，确认样式。掌柜感慨：\"自唐以来，剪纸为钱，扎纸为马，便是如此传承。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡3：小厮求助",
                        text: "桥边饭馆，送菜小厮左手托三碗热菜，右臂叠二十个空碗，桌旁小孩追蝴蝶要撞他。小厮喊你：\"捕快小哥帮个忙！我是先把菜递给旁边客人腾出手，还是先喊住小孩？\"",
                        choices: [
                            { 
                                text: "\"先递菜！你这碗叠得稳，递完菜就能拦小孩！\"", 
                                result: "小厮快速递菜后拦住小孩，得意说：\"这手'叠碗术'练了三年，碗底沾水就能粘稳，是咱们跑堂的绝活！\"" 
                            },
                            { 
                                text: "\"先喊小孩！菜洒了能重做，撞到人就麻烦了！\"", 
                                result: "你帮喊住小孩，小厮顺利送菜，还告诉你：\"递菜也有讲究，要'先老后幼，先客后主'。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡4：脚店争执",
                        text: "十千脚店门口，客人嚷嚷批酒，掌柜急摆手：\"我们是脚店！不是正店，哪能酿酒批发？\"你看见店门口\"彩楼欢门\"。",
                        choices: [
                            { 
                                text: "\"大哥，脚店真不能酿酒，你要批发得去正店，这儿只能临时歇脚喝酒！\"", 
                                result: "客人明白后不吵了。掌柜解释：\"咱们脚店，就是从孙羊那种正店买酒来卖，供人歇脚而已。\"" 
                            },
                            { 
                                text: "\"掌柜，你楼上不是有贵宾厅吗？先让客人歇脚，再指个近的正店给他呗！\"", 
                                result: "掌柜安排客人去贵宾厅，还画路线：\"您看，从这过虹桥，到孙羊正店不远。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡5：木工难题",
                        text: "大车修理铺，木工愁眉苦脸------一个用木楔劈木板劈得歪，一个拿框架锯不知怎么调锯齿。",
                        choices: [
                            { 
                                text: "\"调框架锯！用锯锯得平，劈木板又费力气又不准！\"", 
                                result: "师傅调好锯，锯出的木板平整：\"这框架锯宋代才普及，比前代的刀锯、弓锯都快多了！\"" 
                            },
                            { 
                                text: "\"先劈小块的！等另一个师傅调好锯，再锯大块的，不耽误干活！\"", 
                                result: "两人分工效率高。师傅边劈边聊：\"以前没好锯时，全靠锛斧劈挖，那才叫费劲！\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡6：膏药围观",
                        text: "卖膏药的老者被质疑：\"你这膏药要是神药，怎么不自己贴治腿疼？\"围观人要散，老者急看你。",
                        choices: [
                            { 
                                text: "\"大叔，你就说说这膏药治什么病，用过的人有没有说好的？\"", 
                                result: "老者如实说：\"此膏主活血化瘀，治腰酸腿疼，邻村张木匠用了就说好。\"" 
                            },
                            { 
                                text: "\"大家别散，挑夫大哥天天赶路，让他试试膏药，好用再买呗！\"", 
                                result: "挑夫试后说：\"热乎乎的，肩头松快不少！\"有人当场买。老者低声说：\"摆摊得把膏药摆满一圈，显得货足。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡7：占卜困惑",
                        text: "卦肆前，白衣男子问算命先生：\"我要去京城赶考，该不该去？\"仆人窃窃私语，男子转头问你。",
                        choices: [
                            { 
                                text: "\"先听先生算，算出结果再结合自己的心意，心里有底！\"", 
                                result: "先生算出\"吉兆\"，男子高兴：\"科考前占卜问路，是常例，求个心安。\"" 
                            },
                            { 
                                text: "\"占卜是图个安心，你本来就想去赶考，别因为算卦犹豫！\"", 
                                result: "男子坚定心意。算命先生笑捋胡须：\"心诚则灵，志坚即是吉兆。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡8：馕饼疑问",
                        text: "馕饼铺前，书生问：\"这饼像西域吃食，怎么在汴河旁卖？\"店主说：\"这饼有2000多年历史，早传到中原了！\"书生转头问你。",
                        choices: [
                            { 
                                text: "\"这饼叫馕，是西域传过来的，但传了很久，宋代在汴河旁出现很正常！\"", 
                                result: "书生明白后，和你讨论：\"岂止是馕，胡饼、汤饼，皆是饮食交融之证。\"" 
                            },
                            { 
                                text: "\"你尝尝就知道了，不管是哪的，好吃就行！店主，给我们各来一个呗！\"", 
                                result: "你和书生尝了馕，店主说：\"很多西域客商和本地船夫都爱买，耐放管饱。\"" 
                            }
                        ]
                    },
                    {
                        title: "关卡9：花农定价",
                        text: "花苗摊前，买主嫌红色花枝五文钱一棵贵，旁边小贩帮腔。花农问你：\"捕快小哥，我是少要一文钱促成生意，还是说清楚花苗的好处？\"",
                        choices: [
                            { 
                                text: "\"少要一文钱吧，清明买花苗的人多，薄利多销更划算！\"", 
                                result: "买主爽快买下。花农笑呵呵：\"清明前后，种花移木，正是旺季，走量更快。\"" 
                            },
                            { 
                                text: "\"说清楚好处，比如栽活了能开很久，买主知道值就愿意买了！\"", 
                                result: "花农讲了：\"这牡丹苗，悉心照料，能开几十年呢。\"买主高兴买下。" 
                            }
                        ]
                    },
                    {
                        title: "关卡10：盐铺核查",
                        text: "盐铺里，店主乐呵呵称重，你想起知府说的\"盐引制度\"。店主递上批条：\"捕快小哥，我这盐引是刚换的，指定在这儿卖，没违规！\"",
                        choices: [
                            { 
                                text: "\"店主，我看看你称盐的工具，再确认下盐价是不是四十文一斤？\"", 
                                result: "你确认盐价和工具合规。店主说：\"官盐定价四十文，童叟无欺，价稳人心才安。\"" 
                            },
                            { 
                                text: "\"你这地段确实不繁华，符合规定，再跟我说说拿盐引的流程呗？\"", 
                                result: "店主细细道来：\"先向官府缴钱，领'引'（批条），再凭引到指定盐场取盐，只能在划定区域贩卖。\"" 
                            }
                        ]
                    }
                ]
            }
        };

        // 当前任务和场景索引
        let currentTask = null;
        let currentSceneIndex = 0;
        let currentChoiceResult = null;

        // 任务圆圈点击事件
        document.querySelectorAll('.task-circle').forEach(circle => {
            circle.addEventListener('click', function() {
                const taskId = this.dataset.task;
                // 显示任务介绍页面
                document.getElementById(`${taskId}-intro`).style.display = 'flex';
                document.getElementById(`${taskId}-intro`).querySelector('.intro-bg').style.backgroundImage = 
                    document.getElementById('selection-bg').style.backgroundImage;
            });
        });

        // 开始挑战按钮事件
        document.querySelectorAll('.intro-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const taskId = this.dataset.task;
                currentTask = taskId;
                currentSceneIndex = 0;
                // 隐藏任务介绍页面
                document.getElementById(`${taskId}-intro`).style.display = 'none';
                // 显示第一个场景
                showScene();
            });
        });

        // 关闭按钮事件
        document.querySelectorAll('.close-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.getElementById('task-scene').style.display = 'none';
                document.getElementById('task-selection').style.display = 'flex';
            });
        });

        // 显示场景
        function showScene() {
            const scene = taskData[currentTask].scenes[currentSceneIndex];
            const sceneElement = document.getElementById('task-scene');
            const titleElement = document.getElementById('scene-title');
            const textElement = document.getElementById('scene-text');
            const choicesElement = document.getElementById('scene-choices');
            const nextBtn = document.getElementById('scene-next-btn');

            titleElement.textContent = scene.title;
            textElement.textContent = scene.text;
            choicesElement.innerHTML = '';

            // 设置场景背景图片
            setScene(currentSceneIndex);

            // 如果有选择结果，显示结果
            if (currentChoiceResult) {
                textElement.textContent = currentChoiceResult;
                nextBtn.style.display = 'block';
                nextBtn.onclick = function() {
                    currentChoiceResult = null;
                    currentSceneIndex++;
                    if (currentSceneIndex < taskData[currentTask].scenes.length) {
                        showScene();
                    } else {
                        // 显示任务完成
                        showTaskComplete();
                    }
                };
            } else {
                // 显示选项
                scene.choices.forEach((choice, index) => {
                    const choiceBtn = document.createElement('button');
                    choiceBtn.className = 'choice-btn';
                    choiceBtn.textContent = choice.text;
                    choiceBtn.onclick = function() {
                        currentChoiceResult = choice.result;
                        showScene();
                    };
                    choicesElement.appendChild(choiceBtn);
                });
                nextBtn.style.display = 'none';
            }

            sceneElement.style.display = 'flex';
        }

        // 显示任务完成
        function showTaskComplete() {
            const sceneElement = document.getElementById('task-scene');
            const titleElement = document.getElementById('scene-title');
            const textElement = document.getElementById('scene-text');
            const choicesElement = document.getElementById('scene-choices');
            const nextBtn = document.getElementById('scene-next-btn');

            titleElement.textContent = `恭喜完成${taskData[currentTask].title}`;
            textElement.innerHTML = `
                <div class="result-content">
                    <p class="result-text">您已成功完成${taskData[currentTask].title}的所有关卡！</p>
                    <p class="achievement">获得成就：${getRandomAchievement(currentTask)}</p>
                </div>
            `;
            choicesElement.innerHTML = '';
            nextBtn.style.display = 'block';
            nextBtn.textContent = '下一关';
            nextBtn.onclick = function() {
                sceneElement.style.display = 'none';
                document.getElementById('task-selection').style.display = 'flex';
                currentTask = null;
                currentSceneIndex = 0;
                currentChoiceResult = null;
            };
            sceneElement.style.display = 'flex';
        }

        // 随机获取成就
        function getRandomAchievement(taskId) {
            const achievements = {
                tea: ["汴梁茶魁", "诚信茶商"],
                apprentice: ["汴京雅酿客", "市井酒灵通"],
                bridge: ["虹桥巧工", "细致桥工"],
                inspector: ["汴河博古郎", "市井知情人"]
            };
            const taskAchievements = achievements[taskId];
            return taskAchievements[Math.floor(Math.random() * taskAchievements.length)];
        }

        // 初始化游戏
        function initGame() {
            // 这里可以添加其他初始化代码
        }

        // 返回卷首按钮事件
        document.getElementById('backToStart').onclick = function() {
            document.getElementById('task-scene').style.display = 'none';
            document.getElementById('task-selection').style.display = 'none';
            document.getElementById('cover').style.display = 'block';
            document.getElementById('backToStart').style.display = 'none';
            // 隐藏所有任务介绍页面
            document.querySelectorAll('.task-intro').forEach(intro => {
                intro.style.display = 'none';
            });
            currentTask = null;
            currentSceneIndex = 0;
            currentChoiceResult = null;
        };

        // 启动
        initGame();
        document.getElementById('task-scene').style.display = 'none';
    </script>
</body>
</html>